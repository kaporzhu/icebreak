{% extends "page.html" %}
{% load static %}

{% block extracss_compressed %}
<link rel="stylesheet" href="{% static 'css/order.css' %}">
{% endblock %}

{% block extrajs_compress %}
<script src="{% static 'js/order-staff.js' %}"></script>
{% endblock %}

{% block title %}所有优惠码{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-12 well-shadow">
            <div class="row">
                <h4>所有优惠码</h4>
                <hr />
                <form class="form-inline">
                    <div class="form-group">
                        <select name="shop" class="form-control input-sm">
                            <option value="all">所有店铺</option>
                            {% for sp in shops %}
                                {% if shop == sp.id|lower %}
                                <option value="{{ sp.id }}" selected="selected">{{ sp.name }}</option>
                                {% else %}
                                <option value="{{ sp.id }}">{{ sp.name }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <select name="status" class="form-control input-sm">
                            <option value="all">所有状态</option>
                            {% if status == 'true' %}
                            <option value="true" selected="selected">已经被使用</option>
                            {% else %}
                            <option value="true">已经被使用</option>
                            {% endif %}
                            {% if status == 'false' %}
                            <option value="false" selected="selected">未被使用</option>
                            {% else %}
                            <option value="false">未被使用</option>
                            {% endif %}
                        </select>
                    </div>
                    <div class="form-group">
                        <input class="input-sm form-control" name="code" placeholder="优惠码" />
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-sm">查询</button>
                    </div>
                </form>
                <table class="table table-bordered table-hover" id="all-orders">
                    <tr>
                        <th>店铺</th>
                        <th>创建人</th>
                        <th>优惠码</th>
                        <th>优惠金额</th>
                        <th>是否已经使用</th>
                        <th>创建时间</th>
                        <th>使用时间</th>
                    </tr>
                    {% for coupon in object_list %}
                    <tr>
                        <td>{{ coupon.shop.name }}</td>
                        <td>{{ coupon.creator.get_full_name }}</td>
                        <td>{{ coupon.code_format }}</td>
                        <td>{{ coupon.discount }}</td>
                        <td>{% if coupon.is_used %}是{% else %}否{% endif %}</td>
                        <td>{{ coupon.created_at|date:'m-d H:i' }}</td>
                        <td>{% if coupon.is_used %}{{ coupon.used_at|date:"m-d H:i" }}{% endif %}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}
